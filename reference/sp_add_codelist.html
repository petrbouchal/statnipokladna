<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add codelist data to downloaded data — sp_add_codelist • statnipokladna</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Add codelist data to downloaded data — sp_add_codelist"><meta property="og:description" content="Joins a provided codelist, or downloads and processes one if necessary, and adds it to the data."><meta property="og:image" content="https://petrbouchal.xyz/statnipokladna/reference/figures/card.png"><meta property="og:image:alt" content="statnipokladna: R package for using Czech public finance data (Monitor Státní pokladny)"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@petrbouchal"><meta name="twitter:site" content="@petrbouchal"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statnipokladna</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/statnipokladna.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data-issues-cz.html">Známé datové zádrhele</a>
    </li>
    <li>
      <a href="../articles/how-the-data-works-cz.html">Jak fungují open data státní pokladny</a>
    </li>
    <li>
      <a href="../articles/how-the-data-works.html">How the data works</a>
    </li>
    <li>
      <a href="../articles/workflow.html">statnipokladna workflows and reproducibility</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/petrbouchal/statnipokladna/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
<li>
  <a href="https://petrbouchal.xyz" class="external-link">
    <span class="fa fa-asterisk fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add codelist data to downloaded data</h1>
    <small class="dont-index">Source: <a href="https://github.com/petrbouchal/statnipokladna/blob/v0.7.4/R/codelists.R" class="external-link"><code>R/codelists.R</code></a></small>
    <div class="hidden name"><code>sp_add_codelist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Joins a provided codelist, or downloads and processes one if necessary, and adds it to the data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sp_add_codelist</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  codelist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  period_column <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">vykaz_date</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redownload <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dest_dir <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame returned by <code><a href="sp_get_table.html">sp_get_table()</a></code>.</p></dd>


<dt id="arg-codelist">codelist<a class="anchor" aria-label="anchor" href="#arg-codelist"></a></dt>
<dd><p>The codelist to add. Either a character vector of length one (see <code>sp_tables</code> for possible values), or a data frame returned by <code><a href="sp_get_codelist.html">sp_get_codelist()</a></code>.</p></dd>


<dt id="arg-period-column">period_column<a class="anchor" aria-label="anchor" href="#arg-period-column"></a></dt>
<dd><p>Unquoted column name of column identifying the data period in <code>data</code>. Leave to default if you have not changed the <code>data</code> object returned by <code><a href="sp_get_table.html">sp_get_table()</a></code>.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>character. Columns by which to join the codelist. Same form as for <code>dplyr::left_join()``.</code>.</p></dd>


<dt id="arg-redownload">redownload<a class="anchor" aria-label="anchor" href="#arg-redownload"></a></dt>
<dd><p>Redownload even if file has already been downloaded? Defaults to FALSE.</p></dd>


<dt id="arg-dest-dir">dest_dir<a class="anchor" aria-label="anchor" href="#arg-dest-dir"></a></dt>
<dd><p>character. Directory in which downloaded files will be stored.
If left unset, will use the <code>statnipokladna.dest_dir</code> option if the option is set, and <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code> otherwise. Will be created if it does not exist.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a> of same length as <code>data</code>, with added columns from <code>codelist</code>. See Details.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>data</code> argument should be a data frame produced by <code><a href="sp_get_table.html">sp_get_table()</a></code> If this is true, the <code>period_column</code> argument is not needed.
The <code>codelist</code> argument, if a data frame, should be a data frame produced by
<code><a href="sp_get_codelist.html">sp_get_codelist()</a></code>. Specifically, it assumes it contains the following columns:</p><ul><li><p>start_date, a date</p></li>
<li><p>end_date, a date</p></li>
<li><p>column with the code, character usually named the same as the codelist</p></li>
</ul><p>#' You can usually tell which codelist you need from the name of the column whose code you
are looking to expand, e.g. the codes in column paragraf can be expanded by codelist paragraf.</p>
<p>The function filters the codelist to obtain a set of entries relevant to the time period of <code>data</code>.
If <code>data</code> contains tables for multiple periods, this is handled appropriately.
Codelist-originating columns in the resulting data frame are renamed so they do not interfere with
joining additional codelists, perhaps in a single pipe call.</p>
<p>Note that some codelists are "secondary" and can only be joined onto other codelists.
If a codelist does not join using <code>sp_add_codelis()</code>, store the output of <code><a href="sp_get_codelist.html">sp_get_codelist()</a></code> and join
it manually using <code>dplyr</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other Core workflow:
<code><a href="add_codelist.html">add_codelist</a>()</code>,
<code><a href="get_codelist.html">get_codelist</a>()</code>,
<code><a href="sp_get_codelist.html">sp_get_codelist</a>()</code>,
<code><a href="sp_get_dataset.html">sp_get_dataset</a>()</code>,
<code><a href="sp_get_table.html">sp_get_table</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sp_get_table.html">sp_get_table</a></span><span class="op">(</span><span class="st">"budget-central"</span>, <span class="fl">2017</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">sp_add_codelist</span><span class="op">(</span><span class="st">"polozka"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">sp_add_codelist</span><span class="op">(</span><span class="st">"paragraf"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pol</span> <span class="op">&lt;-</span> <span class="fu"><a href="sp_get_codelist.html">sp_get_codelist</a></span><span class="op">(</span><span class="st">"paragraf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="sp_get_codelist.html">sp_get_codelist</a></span><span class="op">(</span><span class="st">"polozka"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="sp_get_table.html">sp_get_table</a></span><span class="op">(</span><span class="st">"budget-central"</span>, <span class="fl">2017</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">sp_add_codelist</span><span class="op">(</span><span class="va">pol</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">sp_add_codelist</span><span class="op">(</span><span class="va">par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://petrbouchal.xyz" class="external-link">Petr Bouchal</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

